diff --git a/MidiWorks.vcxproj b/MidiWorks.vcxproj
index 32393eb..8685778 100644
--- a/MidiWorks.vcxproj
+++ b/MidiWorks.vcxproj
@@ -141,6 +141,7 @@
   <ItemGroup>
     <ClCompile Include="src\App.cpp" />
     <ClCompile Include="src\AppModel\AppModel.cpp" />
+    <ClCompile Include="src\Commands\NoteEditCommands.cpp" />
     <ClCompile Include="src\MainFrame\MainFrame.cpp" />
     <ClCompile Include="src\Panels\MidiCanvas.cpp" />
     <ClCompile Include="src\RtMidiWrapper\RtMidi\RtMidi.cpp" />
@@ -167,6 +168,7 @@
     <ClInclude Include="src\Panels\Panels.h" />
     <ClInclude Include="src\Panels\SoundBankPanel.h" />
     <ClInclude Include="src\Panels\TransportPanel.h" />
+    <ClInclude Include="src\Panels\UndoHistoryPanel.h" />
     <ClInclude Include="src\RtMidiWrapper\MidiDevice\MidiError.h" />
     <ClInclude Include="src\RtMidiWrapper\MidiDevice\MidiIn.h" />
     <ClInclude Include="src\RtMidiWrapper\MidiDevice\MidiInCallback.h" />
diff --git a/MidiWorks.vcxproj.filters b/MidiWorks.vcxproj.filters
index 5f45fa9..ce8b7c1 100644
--- a/MidiWorks.vcxproj.filters
+++ b/MidiWorks.vcxproj.filters
@@ -30,6 +30,9 @@
     <ClCompile Include="src\AppModel\AppModel.cpp">
       <Filter>Source Files</Filter>
     </ClCompile>
+    <ClCompile Include="src\Commands\NoteEditCommands.cpp">
+      <Filter>Source Files</Filter>
+    </ClCompile>
   </ItemGroup>
   <ItemGroup>
     <ClInclude Include="src\MainFrame\MainFrame.h">
@@ -119,5 +122,8 @@
     <ClInclude Include="src\External\json.hpp">
       <Filter>Header Files</Filter>
     </ClInclude>
+    <ClInclude Include="src\Panels\UndoHistoryPanel.h">
+      <Filter>Header Files</Filter>
+    </ClInclude>
   </ItemGroup>
 </Project>
\ No newline at end of file
diff --git a/src/AppModel/AppModel.cpp b/src/AppModel/AppModel.cpp
index e2847d9..2ee936a 100644
--- a/src/AppModel/AppModel.cpp
+++ b/src/AppModel/AppModel.cpp
@@ -111,8 +111,13 @@ void AppModel::CheckMidiInQueue()
 	auto currentTick = mTransport.GetCurrentTick();
 	auto channels = mSoundBank.GetAllChannels();
 	bool solosFound = mSoundBank.SolosFound();
-	mLogMessage = {mm, currentTick}; // logging midi in messages 
-	mUpdateLog = true;
+
+	// Notify callback of MIDI event (if registered)
+	if (mLogCallback)
+	{
+		mLogCallback({mm, currentTick});
+	}
+
 	for (MidiChannel& c : channels)
 	{
 		bool shouldPlay = solosFound ? c.solo : (c.record && !c.mute);
@@ -136,6 +141,39 @@ TrackSet& AppModel::GetTrackSet() { return mTrackSet; }
 Track& AppModel::GetRecordingBuffer() { return mRecordingBuffer; }
 Track& AppModel::GetTrack(ubyte c) { return mTrackSet.GetTrack(c); }
 
+// MIDI Input port management
+std::vector<std::string> AppModel::GetMidiInputPortNames() const
+{
+	return mMidiIn->getPortNames();
+}
+
+void AppModel::SetMidiInputPort(int portIndex)
+{
+	mMidiIn->changePort(portIndex);
+}
+
+int AppModel::GetCurrentMidiInputPort() const
+{
+	return mMidiIn->getCurrentPort();
+}
+
+// Logging system
+void AppModel::SetLogCallback(LogCallback callback)
+{
+	mLogCallback = callback;
+}
+
+// Metronome settings
+bool AppModel::IsMetronomeEnabled() const
+{
+	return mMetronomeEnabled;
+}
+
+void AppModel::SetMetronomeEnabled(bool enabled)
+{
+	mMetronomeEnabled = enabled;
+}
+
 // Command Pattern - Undo/Redo System
 void AppModel::ExecuteCommand(std::unique_ptr<Command> cmd)
 {
diff --git a/src/AppModel/AppModel.h b/src/AppModel/AppModel.h
index 74dd57b..7a1346f 100644
--- a/src/AppModel/AppModel.h
+++ b/src/AppModel/AppModel.h
@@ -4,6 +4,7 @@
 #include <memory>
 #include <chrono>
 #include <vector>
+#include <functional>
 #include "SoundBank.h"
 #include "Transport.h"
 #include "TrackSet.h"
@@ -13,28 +14,36 @@ class AppModel
 {
 
 public:
-	std::shared_ptr<MidiIn> mMidiIn;
-	TimedMidiEvent			mLogMessage{MidiMessage::NoteOff(0), 0};
-	bool					mUpdateLog = false;
-	bool					mMetronomeEnabled = true;  // Metronome on by default
-
 	AppModel();
 	void InitializeMetronome();
 	// Called inside of MainFrame::OnTimer event
 	void Update();
-	/*  Checks for Midi In Messages
+
+	/*  Checks for Messages from Midi In device
 		If a SoundBank Channel is active, the message will playback.
 		If a SoundBank Channel is set to record: the message will be pushed to the mRecordingBuffer.
-		This buffer is used to temporarily store the midi messages during recording, 
-		when finished recording, the buffer is added to the track and sorted by timestamp. 
-	*/
+		This buffer is used to temporarily store the midi messages during recording,
+		when finished recording, the buffer is added to the track and sorted by timestamp. */
 	void CheckMidiInQueue();
-	
-    SoundBank& GetSoundBank(); 
-	Transport& GetTransport(); 
-	TrackSet& GetTrackSet(); 
-	Track& GetRecordingBuffer(); 
-	Track& GetTrack(ubyte c); 
+
+    SoundBank& GetSoundBank();
+	Transport& GetTransport();
+	TrackSet& GetTrackSet();
+	Track& GetRecordingBuffer();
+	Track& GetTrack(ubyte c);
+
+	// MIDI Input port management
+	std::vector<std::string> GetMidiInputPortNames() const;
+	void SetMidiInputPort(int portIndex);
+	int GetCurrentMidiInputPort() const;
+
+	// Logging system (callback pattern)
+	using LogCallback = std::function<void(const TimedMidiEvent&)>;
+	void SetLogCallback(LogCallback callback);
+
+	// Metronome settings
+	bool IsMetronomeEnabled() const;
+	void SetMetronomeEnabled(bool enabled); 
 
 	// Command Pattern - Undo/Redo System
 	void ExecuteCommand(std::unique_ptr<Command> cmd);
@@ -54,6 +63,15 @@ private:
 	TrackSet	mTrackSet;
 	Track		mRecordingBuffer;
 
+	// MIDI Input
+	std::shared_ptr<MidiIn> mMidiIn;
+
+	// Logging
+	LogCallback mLogCallback;
+
+	// Metronome
+	bool mMetronomeEnabled = true;  // Metronome on by default
+
 	// Command Pattern - Undo/Redo stacks
 	std::vector<std::unique_ptr<Command>> mUndoStack;
 	std::vector<std::unique_ptr<Command>> mRedoStack;
diff --git a/src/Commands/NoteEditCommands.h b/src/Commands/NoteEditCommands.h
index 6546053..fdeab92 100644
--- a/src/Commands/NoteEditCommands.h
+++ b/src/Commands/NoteEditCommands.h
@@ -16,41 +16,9 @@ public:
 	{
 	}
 
-	void Execute() override
-	{
-		// Add both note-on and note-off events to the track
-		mTrack.push_back(mNoteOn);
-		mTrack.push_back(mNoteOff);
-
-		// Sort track by tick to maintain chronological order
-		std::sort(mTrack.begin(), mTrack.end(), [](const TimedMidiEvent& a, const TimedMidiEvent& b) {
-			return a.tick < b.tick;
-		});
-
-		// Store indices after sorting for undo
-		FindNoteIndices();
-	}
-
-	void Undo() override
-	{
-		// Remove note-off first (higher index) to avoid invalidating note-on index
-		if (mNoteOffIndex < mTrack.size() && mTrack[mNoteOffIndex].tick == mNoteOff.tick)
-		{
-			mTrack.erase(mTrack.begin() + mNoteOffIndex);
-		}
-
-		// Remove note-on
-		if (mNoteOnIndex < mTrack.size() && mTrack[mNoteOnIndex].tick == mNoteOn.tick)
-		{
-			mTrack.erase(mTrack.begin() + mNoteOnIndex);
-		}
-	}
-
-	std::string GetDescription() const override
-	{
-		return "Add Note (Pitch: " + std::to_string(mNoteOn.mm.mData[1]) +
-		       ", Tick: " + std::to_string(mNoteOn.tick) + ")";
-	}
+	void Execute() override;
+	void Undo() override;
+	std::string GetDescription() const override;
 
 private:
 	Track& mTrack;
@@ -59,25 +27,7 @@ private:
 	size_t mNoteOnIndex = 0;
 	size_t mNoteOffIndex = 0;
 
-	// Find where the notes ended up after sorting
-	void FindNoteIndices()
-	{
-		for (size_t i = 0; i < mTrack.size(); i++)
-		{
-			if (mTrack[i].tick == mNoteOn.tick &&
-				mTrack[i].mm.mData[1] == mNoteOn.mm.mData[1] &&
-				mTrack[i].mm.getEventType() == MidiEvent::NOTE_ON)
-			{
-				mNoteOnIndex = i;
-			}
-			if (mTrack[i].tick == mNoteOff.tick &&
-				mTrack[i].mm.mData[1] == mNoteOff.mm.mData[1] &&
-				mTrack[i].mm.getEventType() == MidiEvent::NOTE_OFF)
-			{
-				mNoteOffIndex = i;
-			}
-		}
-	}
+	void FindNoteIndices();
 };
 
 /// <summary>
@@ -95,38 +45,9 @@ public:
 		mNoteOff = mTrack[noteOffIndex];
 	}
 
-	void Execute() override
-	{
-		// Delete note-off first (higher index) to avoid invalidating note-on index
-		if (mNoteOffIndex < mTrack.size())
-		{
-			mTrack.erase(mTrack.begin() + mNoteOffIndex);
-		}
-
-		// Delete note-on
-		if (mNoteOnIndex < mTrack.size())
-		{
-			mTrack.erase(mTrack.begin() + mNoteOnIndex);
-		}
-	}
-
-	void Undo() override
-	{
-		// Re-add the deleted notes
-		mTrack.push_back(mNoteOn);
-		mTrack.push_back(mNoteOff);
-
-		// Re-sort to maintain chronological order
-		std::sort(mTrack.begin(), mTrack.end(), [](const TimedMidiEvent& a, const TimedMidiEvent& b) {
-			return a.tick < b.tick;
-		});
-	}
-
-	std::string GetDescription() const override
-	{
-		return "Delete Note (Pitch: " + std::to_string(mNoteOn.mm.mData[1]) +
-		       ", Tick: " + std::to_string(mNoteOn.tick) + ")";
-	}
+	void Execute() override;
+	void Undo() override;
+	std::string GetDescription() const override;
 
 private:
 	Track& mTrack;
@@ -154,58 +75,9 @@ public:
 		mNoteDuration = mTrack[noteOffIndex].tick - mTrack[noteOnIndex].tick;
 	}
 
-	void Execute() override
-	{
-		// Update note-on position
-		if (mNoteOnIndex < mTrack.size())
-		{
-			mTrack[mNoteOnIndex].tick = mNewTick;
-			mTrack[mNoteOnIndex].mm.mData[1] = mNewPitch;  // Pitch
-		}
-
-		// Update note-off position (maintain duration)
-		if (mNoteOffIndex < mTrack.size())
-		{
-			mTrack[mNoteOffIndex].tick = mNewTick + mNoteDuration;
-			mTrack[mNoteOffIndex].mm.mData[1] = mNewPitch;  // Pitch
-		}
-
-		// Re-sort track after moving
-		std::sort(mTrack.begin(), mTrack.end(), [](const TimedMidiEvent& a, const TimedMidiEvent& b) {
-			return a.tick < b.tick;
-		});
-	}
-
-	void Undo() override
-	{
-		// Find the notes again (indices may have changed after sorting)
-		size_t noteOnIdx = FindNoteIndex(mNewTick, mNewPitch, MidiEvent::NOTE_ON);
-		size_t noteOffIdx = FindNoteIndex(mNewTick + mNoteDuration, mNewPitch, MidiEvent::NOTE_OFF);
-
-		// Restore original position
-		if (noteOnIdx < mTrack.size())
-		{
-			mTrack[noteOnIdx].tick = mOldTick;
-			mTrack[noteOnIdx].mm.mData[1] = mOldPitch;
-		}
-
-		if (noteOffIdx < mTrack.size())
-		{
-			mTrack[noteOffIdx].tick = mOldTick + mNoteDuration;
-			mTrack[noteOffIdx].mm.mData[1] = mOldPitch;
-		}
-
-		// Re-sort track
-		std::sort(mTrack.begin(), mTrack.end(), [](const TimedMidiEvent& a, const TimedMidiEvent& b) {
-			return a.tick < b.tick;
-		});
-	}
-
-	std::string GetDescription() const override
-	{
-		return "Move Note (From Pitch: " + std::to_string(mOldPitch) +
-		       " to " + std::to_string(mNewPitch) + ")";
-	}
+	void Execute() override;
+	void Undo() override;
+	std::string GetDescription() const override;
 
 private:
 	Track& mTrack;
@@ -217,19 +89,7 @@ private:
 	uint8_t mNewPitch;
 	uint64_t mNoteDuration;
 
-	size_t FindNoteIndex(uint64_t tick, uint8_t pitch, MidiEvent eventType)
-	{
-		for (size_t i = 0; i < mTrack.size(); i++)
-		{
-			if (mTrack[i].tick == tick &&
-				mTrack[i].mm.mData[1] == pitch &&
-				mTrack[i].mm.getEventType() == eventType)
-			{
-				return i;
-			}
-		}
-		return mTrack.size();  // Not found
-	}
+	size_t FindNoteIndex(uint64_t tick, uint8_t pitch, MidiEvent eventType);
 };
 
 /// <summary>
@@ -249,42 +109,9 @@ public:
 		mPitch = mTrack[noteOnIndex].mm.mData[1];
 	}
 
-	void Execute() override
-	{
-		// Update note-off tick to reflect new duration
-		if (mNoteOffIndex < mTrack.size())
-		{
-			mTrack[mNoteOffIndex].tick = mNoteOnTick + mNewDuration;
-		}
-
-		// Re-sort track (note-off might have moved)
-		std::sort(mTrack.begin(), mTrack.end(), [](const TimedMidiEvent& a, const TimedMidiEvent& b) {
-			return a.tick < b.tick;
-		});
-	}
-
-	void Undo() override
-	{
-		// Find note-off again (index may have changed)
-		size_t noteOffIdx = FindNoteIndex(mNoteOnTick + mNewDuration, mPitch, MidiEvent::NOTE_OFF);
-
-		// Restore original duration
-		if (noteOffIdx < mTrack.size())
-		{
-			mTrack[noteOffIdx].tick = mNoteOnTick + mOldDuration;
-		}
-
-		// Re-sort track
-		std::sort(mTrack.begin(), mTrack.end(), [](const TimedMidiEvent& a, const TimedMidiEvent& b) {
-			return a.tick < b.tick;
-		});
-	}
-
-	std::string GetDescription() const override
-	{
-		return "Resize Note (Pitch: " + std::to_string(mPitch) +
-		       ", Duration: " + std::to_string(mOldDuration) + " -> " + std::to_string(mNewDuration) + ")";
-	}
+	void Execute() override;
+	void Undo() override;
+	std::string GetDescription() const override;
 
 private:
 	Track& mTrack;
@@ -295,17 +122,5 @@ private:
 	uint64_t mNoteOnTick;
 	uint8_t mPitch;
 
-	size_t FindNoteIndex(uint64_t tick, uint8_t pitch, MidiEvent eventType)
-	{
-		for (size_t i = 0; i < mTrack.size(); i++)
-		{
-			if (mTrack[i].tick == tick &&
-				mTrack[i].mm.mData[1] == pitch &&
-				mTrack[i].mm.getEventType() == eventType)
-			{
-				return i;
-			}
-		}
-		return mTrack.size();  // Not found
-	}
+	size_t FindNoteIndex(uint64_t tick, uint8_t pitch, MidiEvent eventType);
 };
diff --git a/src/MainFrame/MainFrame.cpp b/src/MainFrame/MainFrame.cpp
index 7e0ad4f..a22f1d6 100644
--- a/src/MainFrame/MainFrame.cpp
+++ b/src/MainFrame/MainFrame.cpp
@@ -74,6 +74,13 @@ void MainFrame::CreateDockablePanes()
 	RegisterPanel(midiCanvasInfo);
 	RegisterPanel(logPanelInfo);
 	RegisterPanel(undoHistoryPanelInfo);
+
+	// Register log callback for MIDI event logging
+	mAppModel->SetLogCallback([this](const TimedMidiEvent& event) {
+		if (mLogPanel) {
+			mLogPanel->LogMidiEvent(event);
+		}
+	});
 }
 
 // Add Panels to map, used to toggle visibility
@@ -170,11 +177,7 @@ void MainFrame::OnTimer(wxTimerEvent&)
 	// @TODO: If needed later on, make a MainFrame::Update function for the multiple panes
 	mTransportPanel->UpdateDisplay();
 	mMidiCanvasPanel->Update();
-	if (mAppModel->mUpdateLog)
-	{
-		mLogPanel->LogMidiEvent(mAppModel->mLogMessage);
-		mAppModel->mUpdateLog = false;
-	}
+	// Note: Logging now handled via callback - no polling needed
 }
 
 // Debug Tool for layout, when docked panes are resized, the dimensions are shown in controlbar
diff --git a/src/MainFrame/MainFrame.h b/src/MainFrame/MainFrame.h
index ee0da6b..8b5de66 100644
--- a/src/MainFrame/MainFrame.h
+++ b/src/MainFrame/MainFrame.h
@@ -13,16 +13,18 @@ public:
     MainFrame();
 
 private:
-    wxAuiManager mAuiManager;
     std::shared_ptr<AppModel> mAppModel;
+    wxAuiManager mAuiManager;
     wxTimer mTimer;
+
+    // Panel Pointers
+	std::unordered_map<int, PanelInfo> mPanels;
     MidiSettingsPanel* mMidiSettingsPanel;
     SoundBankPanel* mSoundBankPanel;
     TransportPanel* mTransportPanel;
     MidiCanvasPanel* mMidiCanvasPanel;
     LogPanel* mLogPanel;
     UndoHistoryPanel* mUndoHistoryPanel;
-	std::unordered_map<int, PanelInfo> mPanels;
 
     void CreateDockablePanes();
     void RegisterPanel(const PanelInfo& info);
diff --git a/src/Panels/MidiSettings.h b/src/Panels/MidiSettings.h
index deb6e07..0cccc30 100644
--- a/src/Panels/MidiSettings.h
+++ b/src/Panels/MidiSettings.h
@@ -24,7 +24,7 @@ private:
 	{
 		wxFont mainFont(wxFontInfo(wxSize(0, 12)));
 
-		auto& inPorts = mAppModel->mMidiIn->getPortNames();
+		auto inPorts = mAppModel->GetMidiInputPortNames();
 
 		mInPortList = new wxRadioBox(this, wxID_ANY, wxT("Midi In Port"),
 			wxDefaultPosition, wxDefaultSize, inPorts, 1, wxRA_SPECIFY_COLS);
@@ -51,6 +51,6 @@ private:
 	void OnInPortClicked(wxCommandEvent& evt)
 	{
 		unsigned int p = evt.GetSelection();
-		mAppModel->mMidiIn->changePort(p);
+		mAppModel->SetMidiInputPort(p);
 	}
 };
diff --git a/src/Panels/TransportPanel.h b/src/Panels/TransportPanel.h
index 5f95e18..f1a6b2b 100644
--- a/src/Panels/TransportPanel.h
+++ b/src/Panels/TransportPanel.h
@@ -62,7 +62,7 @@ private:
 
 		// Metronome checkbox (renamed to "Click")
 		mMetronomeCheckBox = new wxCheckBox(this, wxID_ANY, "Click");
-		mMetronomeCheckBox->SetValue(mModel->mMetronomeEnabled);
+		mMetronomeCheckBox->SetValue(mModel->IsMetronomeEnabled());
 	} 
 	
 	void SetupSizers()
@@ -172,7 +172,7 @@ private:
 
 	void OnMetronomeToggle(wxCommandEvent& event)
 	{
-		mModel->mMetronomeEnabled = mMetronomeCheckBox->GetValue();
+		mModel->SetMetronomeEnabled(mMetronomeCheckBox->GetValue());
 	}
 };
 
diff --git a/src/RtMidiWrapper/MidiDevice/MidiIn.h b/src/RtMidiWrapper/MidiDevice/MidiIn.h
index e392d52..6859526 100644
--- a/src/RtMidiWrapper/MidiDevice/MidiIn.h
+++ b/src/RtMidiWrapper/MidiDevice/MidiIn.h
@@ -34,6 +34,11 @@ namespace MidiInterface
 			std::cout << "MidiIn deleted\n";
 		}
 
+		ubyte getCurrentPort()
+		{
+			return mPortNum;
+		}
+
 		void changePort(ubyte p)
 		{
 			mInstrument->closePort();
@@ -64,6 +69,7 @@ namespace MidiInterface
 			}
 			return false;
 		}
+
 		MidiMessage& getMessage()
 		{
 			return mMessage;
@@ -78,6 +84,7 @@ namespace MidiInterface
 		{
 			mInstrument->cancelCallback();
 		}
+
 	private:
 		ubyte mPortNum{0};
 		RtMidiIn* mInstrument;
diff --git a/src/RtMidiWrapper/MidiDevice/MidiOut.h b/src/RtMidiWrapper/MidiDevice/MidiOut.h
index b46e751..0a9fb13 100644
--- a/src/RtMidiWrapper/MidiDevice/MidiOut.h
+++ b/src/RtMidiWrapper/MidiDevice/MidiOut.h
@@ -32,6 +32,11 @@ namespace MidiInterface
             mPlayer->closePort();
             delete mPlayer;
         }
+           
+        ubyte getCurrentPort()
+        {
+            return mPortNum;
+        }
 
         void changePort(ubyte p)
         {
